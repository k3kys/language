http://yeonsoproject001.com/

# 웹 메일 인증 시스템 구축하기

2021년 6월 학교별 언어교환 서비스 구축 프로젝트를 시작하기 앞서

학교 웹 메일 인증 시스템을 구축해보았습니다.

사용자가 웹메일을 작성하면 해당 웹메일로 인증번호가 발송되고

발송된 인증번호를 회원가입 페이지에 작성하면 됩니다.

## 여러 고민들

### 1. 어떻게 인증 시스템을 마련할 것인가?

우선, 대학생을 대상으로 하는 서비스이기 때문에 다른 메일 주소가 아닌 학교의 웹 메일만을 이용할 수 있어야 했습니다.

학교의 웹 메일들은 ac.kr을 이용하기 때문에 해당 부분을 반드시 포함해야만 인증이 가능하도록 했습니다.

에브리타임, 서울42등 메일 인증이 필요한 사이트들을 둘러보았고 대부분 회원가입을 할 수 있는 페이지로 갈 수 있는 링크를

버튼형식으로 이메일로 보내주었습니다. 에브리타임은 앱 서비스이기 때문에 url이 공개되지 않았지만

서울42의 경우 해당 url을 사용하여 메일을 받지 않고도 언제든 접근할 수 있었습니다.

이 부분이 보안상 취약하다고 느껴졌습니다.

따라서 이 부분을 해결하기 위해 인증번호 시스템을 마련했습니다.

사용자가 웹메일을 작성하게 되면, 백엔드에서 6자리 난수가 생성되고 사용자가 적은 웹 메일로 인증번호를 발송하게 됩니다.

인증번호를 받으면, 회원가입 페이지에서 사용자 정보와 함께 인증번호를 적어주게 되면 회원가입이 완료될 수 있게 했습니다.

하지만 이 방법은 역시 메일을 통해 인증번호를 확인해야 하는 번거로움이 가장 큰 걸림돌이었습니다.

이 부분을 해결하기 위해 다시 한 번 고민해봐야 할 것 같습니다.


### 2. redux는 새로고침을 하면 정보가 모두 사라진다.

redux는 react의 상태관리기법으로 일종의 중앙 저장소 역할을 합니다.

백엔드에서 보내온 정보를 redux안에 저장해놓고, 필요할 때 해당 정보를 이용해 랜더링할 수 있는 편리한 기법입니다.

백엔드에서 생성한 인증번호를 프론트에서 사용자가 입력한 정보와 대조하는 과정에서 문제가 발생했습니다.

바로 회원가입 중 새로고침을 하면 redux 내 의 모든 정보가 초기화되기 때문에 랜더링 오류가 생기는 것이었습니다.

이것은 상당히 큰 문제였습니다.

사용자가 회원 가입 중 새로고침을 누르지 않기를 바라기에는, 새로고침은 너무나도 자주 쓰이는 기능이었습니다.

따라서 이 부분을 해결하기 위해 localStrorge를 사용하였습니다.

localStroage를 사용하게 되면, redux 내의 정보가 초기화 되더라도 localStroage에는 정보가 남아있기에

새로고침을 누르더라도 랜더링 오류가 발생하는 현상을 해결할 수 있었습니다.

### 3. localStroage는 사용자에게 정보를 공개할 수 있다.

크롬 내에서 f11을 누른 후 Application 항목으로 들어가게 되면 localStorage 정보를 볼 수 있습니다.

2번 문제를 해결하기 위해 백엔드에서 보내온 정보를 localStroage에 저장하게 되었는데 이로 인해 보안상의 취약점이 생겨난 것입니다.

사용자가 악용한다면 인증번호를 웹메일 인증 없이도 갈취할 수 있는 중대한 문제였습니다.

그래서 한참을 고민했고, 암호화가 필요하다고 판단했습니다. 백엔드에서 redux로 정보를 받아올 때 jwt를 이용해 암호화를 하여

localStroage 내에서는 암호화 된 정보가 남아있도록 했습니다.

이를 통해 새로 생긴 보안 취약성을 해결할 수 있었습니다.

## 마치며

프로젝트 구축 전 연습삼아 만들어본 프로젝트였으나 많은 것을 배울 수 있었습니다.

고작 로그인이지만 1번 문제를 해결하면 2번문제가 따라오는 ,, 문제가 꼬리를 물며 발생한 상황을 처음 접해봤고

이를 해결하는 과정에서 redux에 대한 깊은 이해를 할 수 있었습니다.

